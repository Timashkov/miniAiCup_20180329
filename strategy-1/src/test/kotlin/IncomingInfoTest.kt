import org.json.JSONObject
import utils.Logger
import utils.Vertex


class IncomingInfoTest {

    lateinit var mConfig: WorldConfig
    lateinit var mProcessor: Processor
    val mLogger = Logger()

    @org.junit.Before
    fun setUp() {


        val json = JSONObject("{\"FOOD_MASS\":1,\"GAME_HEIGHT\":990,\"GAME_TICKS\":75000,\"GAME_WIDTH\":990,\"INERTION_FACTOR\":10,\"MAX_FRAGS_CNT\":10,\"SPEED_FACTOR\":25,\"TICKS_TIL_FUSION\":250,\"VIRUS_RADIUS\":22,\"VIRUS_SPLIT_MASS\":80,\"VISCOSITY\":0.25}")
        mConfig = WorldConfig(json)
        mProcessor = Processor(json)

    }

    @org.junit.After
    fun tearDown() {
    }

    @org.junit.Test
    fun testProcessor(){
        val tickData = JSONObject("{\"Mine\":[{\"Id\":\"4.6\",\"M\":71.053249785273081,\"R\":16.858617948725581,\"SX\":-0.74745164266564856,\"SY\":9.1536426170791778e-17,\"TTF\":105,\"X\":706.1723293675708,\"Y\":973.14138205127438},{\"Id\":\"4.4\",\"M\":76.047716843715662,\"R\":17.441068412653586,\"SX\":-0.21000845384891673,\"SY\":2.571861807999605e-17,\"TTF\":105,\"X\":732.43969264876796,\"Y\":972.55893158734636},{\"Id\":\"4.3\",\"M\":86.036650960600809,\"R\":18.551188744724776,\"SX\":-1.3095256482167281,\"SY\":1.603706393489979e-16,\"TTF\":105,\"X\":758.47227592318029,\"Y\":971.44881125527525},{\"Id\":\"4.5\",\"M\":71.053249785273081,\"R\":16.858617948725581,\"SX\":0.9952968135116127,\"SY\":0.012048451458165188,\"TTF\":105,\"X\":721.9897289714221,\"Y\":945.5657786443852}],\"Objects\":[{\"T\":\"F\",\"X\":634,\"Y\":927},{\"T\":\"F\",\"X\":682,\"Y\":948},{\"Id\":\"2.4\",\"M\":135.58272461417752,\"R\":23.28799902217256,\"T\":\"P\",\"X\":727.35950998879741,\"Y\":922.28191715754394},{\"Id\":\"2.3\",\"M\":152.03183538892293,\"R\":24.660238067701044,\"T\":\"P\",\"X\":671.53071676479919,\"Y\":868.79250511672012},{\"Id\":\"2.5\",\"M\":135.61535846193743,\"R\":23.290801485731439,\"T\":\"P\",\"X\":747.01077516188661,\"Y\":866.308460634055},{\"Id\":\"21\",\"M\":40,\"T\":\"V\",\"X\":389.35394633438716,\"Y\":225.35394633438719},{\"Id\":\"22\",\"M\":40,\"T\":\"V\",\"X\":600.64605366561284,\"Y\":225.35394633438719},{\"Id\":\"23\",\"M\":40,\"T\":\"V\",\"X\":600.64605366561284,\"Y\":764.64605366561284},{\"Id\":\"24\",\"M\":40,\"T\":\"V\",\"X\":389.35394633438716,\"Y\":764.64605366561284},{\"Id\":\"265\",\"M\":40,\"T\":\"V\",\"X\":262.35394633438716,\"Y\":277.35394633438716},{\"Id\":\"266\",\"M\":40,\"T\":\"V\",\"X\":727.64605366561284,\"Y\":277.35394633438716},{\"Id\":\"267\",\"M\":40,\"T\":\"V\",\"X\":727.64605366561284,\"Y\":712.64605366561284},{\"Id\":\"268\",\"M\":40,\"T\":\"V\",\"X\":262.35394633438716,\"Y\":712.64605366561284}]}")

        val parsed = mProcessor.parseIncoming(tickData)
        mProcessor.analyzeData(parsed, 2)
        val point = parsed.mineInfo.getBestEscapePoint()
        assert(point!=Vertex(200f,200f))
    }

}

